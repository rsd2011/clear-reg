server:
  port: 8080

spring:
  application:
    name: multi-module-application
  datasource:
    url: jdbc:h2:mem:cleardb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: ""
  jpa:
    hibernate:
      ddl-auto: update
    database-platform: org.hibernate.dialect.H2Dialect
    open-in-view: false
    properties:
      hibernate:
        jdbc:
          use_get_generated_keys: true
  h2:
    console:
      enabled: true
  ldap:
    urls: ""
    base: ""
    username: ""
    password: ""

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized
  metrics:
    tags:
      application: ${spring.application.name}

cache:
  redis:
    enabled: false
  local-ttl-seconds: 300
  redis-ttl-seconds: 600
  local-maximum-size: 10000

security:
  jwt:
    secret: change-me-change-me-change-me-change-me-change-me-32bytes
    access-token-seconds: 900
    refresh-token-seconds: 2592000
    issuer: clear-reg-backend
  auth:
    password-min-length: 12
    require-uppercase: true
    require-lowercase: true
    require-digit: true
    require-special: true
    max-failed-attempts: 5
    lockout-seconds: 900
    password-history-size: 5
    password-expiry-days: 90
  session:
    max-active-sessions: 2
  policy:
    password-policy-enabled: true
    password-history-enabled: true
    account-lock-enabled: true
    enabled-login-types:
      - PASSWORD
      - SSO
      - AD

dw:
  gateway:
    client:
      base-uri: ${DW_GATEWAY_BASE_URI:http://localhost:8090}
  ingestion:
    enabled: false
    batch-cron: "0 30 2 * * *"
    timezone: Asia/Seoul
    incoming-dir: "${DW_INCOMING_DIR:build/dw/incoming}"
    archive-dir: "${DW_ARCHIVE_DIR:build/dw/archive}"
    error-dir: "${DW_ERROR_DIR:build/dw/error}"
    reconciliation-lookback: "30d"
    retention: "90d"
    job-schedules:
      - job-key: DW_INGESTION
        enabled: true
        cron-expression: "0 30 2 * * *"
        timezone: Asia/Seoul
    database:
      enabled: false
      batch-size: 1000

readmodel:
  organization:
    enabled: false
    key-prefix: rm:org
    tenant-id: default
    ttl: 30m

audit:
  kafka:
    topic: audit.events.v1
    bootstrap-servers: ${AUDIT_KAFKA_BOOTSTRAP:localhost:29092}
    acks: all
    retries: 5
    linger-ms: 20
    batch-size: 32768
    compression-type: lz4
    dlq-topic: audit.events.dlq
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
  sensitive-api:
    validation-enabled: true
    reason-parameter: reasonCode
    legal-basis-parameter: legalBasisCode
