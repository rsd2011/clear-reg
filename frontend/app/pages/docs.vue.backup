<script setup lang="ts">
import { ref } from 'vue'
import { useThemeStore } from '~/stores/theme'
import { useAppToast } from '~/composables/useAppToast'
import type { ThemeName, ThemeMode } from '~/themes'

const themeStore = useThemeStore()
const toast = useAppToast()

// Form ìƒíƒœ
const inputValue = ref('')
const searchQuery = ref('')
const checkboxValue = ref(false)
const numberValue = ref(10)

// Data ìƒíƒœ
const tableData = ref([
  { id: 1, name: 'í™ê¸¸ë™', email: 'hong@example.com' },
  { id: 2, name: 'ê¹€ì² ìˆ˜', email: 'kim@example.com' },
  { id: 3, name: 'ì´ì˜í¬', email: 'lee@example.com' },
])
const tableColumns = [
  { field: 'name', header: 'ì´ë¦„', sortable: true },
  { field: 'email', header: 'ì´ë©”ì¼', sortable: true },
]

// Panel ìƒíƒœ
const activeTab = ref('form')

// Overlay ìƒíƒœ
const dialogVisible = ref(false)
const drawerVisible = ref(false)

// Handlers
function handleThemeChange(name: ThemeName) {
  themeStore.setTheme(name)
  toast.success(`í…Œë§ˆ ë³€ê²½: ${name}`)
}

function handleSearch(query: string) {
  toast.info(`ê²€ìƒ‰: ${query}`)
}

function handleConfirm() {
  toast.success('í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤')
}
</script>

<template>
  <NuxtLayout>
    <div class="max-w-7xl mx-auto p-8 space-y-8">
      <!-- í—¤ë” -->
      <header class="text-center space-y-4">
        <h1 class="text-4xl font-bold">ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬</h1>
        <p class="text-lg opacity-70">33ê°œì˜ PrimeVue ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸</p>
      </header>

      <!-- í…Œë§ˆ ì„¤ì • -->
      <section>
        <h2 class="text-2xl font-semibold mb-4">í…Œë§ˆ ì„¤ì •</h2>
        <PanelCard title="í…Œë§ˆ ì„ íƒ">
          <div class="flex gap-2 flex-wrap">
            <ActionButton
              v-for="theme in themeStore.availableThemes"
              :key="theme.value"
              :label="theme.label"
              :severity="themeStore.themeName === theme.value ? 'info' : 'secondary'"
              @click="handleThemeChange(theme.value)"
            />
          </div>
        </PanelCard>
      </section>

      <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
      <PanelTabs
        v-model:value="activeTab"
        :items="[
          { value: 'form', label: 'ğŸ“ Form', icon: 'pi pi-pencil' },
          { value: 'action', label: 'ğŸ”˜ Action', icon: 'pi pi-bolt' },
          { value: 'data', label: 'ğŸ“Š Data', icon: 'pi pi-table' },
          { value: 'panel', label: 'ğŸ“¦ Panel', icon: 'pi pi-box' },
          { value: 'overlay', label: 'ğŸªŸ Overlay', icon: 'pi pi-window-maximize' },
          { value: 'feedback', label: 'ğŸ’¬ Feedback', icon: 'pi pi-comment' },
          { value: 'composite', label: 'ğŸ”— Composite', icon: 'pi pi-link' },
        ]"
      >
        <!-- Form íƒ­ -->
        <template #form>
          <div class="space-y-6">
            <PanelCard title="Form ì»´í¬ë„ŒíŠ¸">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <FormField label="Input" required>
                  <FormInput v-model="inputValue" placeholder="í…ìŠ¤íŠ¸ ì…ë ¥" fluid />
                </FormField>
                <FormField label="Checkbox">
                  <FormCheckbox v-model="checkboxValue" label="ë™ì˜í•©ë‹ˆë‹¤" />
                </FormField>
                <FormField label="Number">
                  <FormNumber v-model="numberValue" :min="0" :max="100" fluid />
                </FormField>
              </div>
            </PanelCard>
          </div>
        </template>

        <!-- Action íƒ­ -->
        <template #action>
          <PanelCard title="Action ì»´í¬ë„ŒíŠ¸">
            <div class="flex gap-2 flex-wrap">
              <ActionButton label="Primary" />
              <ActionButton label="Success" severity="success" />
              <ActionButton label="Icon" icon="pi pi-check" />
              <ActionButton label="Loading" loading />
              <ConfirmButton label="Confirm" @confirm="handleConfirm" />
            </div>
          </PanelCard>
        </template>

        <!-- Data íƒ­ -->
        <template #data>
          <PanelCard title="Data ì»´í¬ë„ŒíŠ¸">
            <DataTable :value="tableData" :columns="tableColumns" paginator :rows="5" />
          </PanelCard>
        </template>

        <!-- Panel íƒ­ -->
        <template #panel>
          <div class="space-y-6">
            <PanelCard title="Card ì»´í¬ë„ŒíŠ¸">
              <p>ê¸°ë³¸ ì¹´ë“œì…ë‹ˆë‹¤</p>
            </PanelCard>
            <PanelToolbar>
              <template #start>
                <span class="font-semibold">Toolbar</span>
              </template>
              <template #end>
                <ActionButton label="ì•¡ì…˜" size="small" />
              </template>
            </PanelToolbar>
          </div>
        </template>

        <!-- Overlay íƒ­ -->
        <template #overlay>
          <PanelCard title="Overlay ì»´í¬ë„ŒíŠ¸">
            <div class="flex gap-2">
              <ActionButton label="Dialog ì—´ê¸°" @click="dialogVisible = true" />
              <ActionButton label="Drawer ì—´ê¸°" @click="drawerVisible = true" />
            </div>
            
            <OverlayDialog v-model:visible="dialogVisible" header="ìƒ˜í”Œ Dialog">
              <p>Dialog ë‚´ìš©ì…ë‹ˆë‹¤</p>
            </OverlayDialog>
            
            <OverlayDrawer v-model:visible="drawerVisible" header="ìƒ˜í”Œ Drawer">
              <p>Drawer ë‚´ìš©ì…ë‹ˆë‹¤</p>
            </OverlayDrawer>
          </PanelCard>
        </template>

        <!-- Feedback íƒ­ -->
        <template #feedback>
          <PanelCard title="Feedback ì»´í¬ë„ŒíŠ¸">
            <div class="space-y-4">
              <div class="flex gap-2 items-center">
                <FeedbackBadge value="New" severity="success" />
                <FeedbackTag value="Important" severity="warn" />
                <StatusBadge status="active" />
              </div>
              <FeedbackProgress :value="60" />
            </div>
          </PanelCard>
        </template>

        <!-- Composite íƒ­ -->
        <template #composite>
          <div class="space-y-6">
            <PanelCard title="Composite ì»´í¬ë„ŒíŠ¸">
              <div class="space-y-4">
                <SearchBar v-model="searchQuery" @search="handleSearch" />
                <DataTableToolbar title="ë°ì´í„° í…Œì´ë¸”" show-refresh show-add />
              </div>
            </PanelCard>
          </div>
        </template>
      </PanelTabs>

      <!-- í‘¸í„° -->
      <footer class="text-center py-8 opacity-50 text-sm">
        <p>Enterman Component Library</p>
        <p>33 Components â€¢ Base + Composite + Common</p>
      </footer>
    </div>
  </NuxtLayout>
</template>
